<!DOCTYPE html>
<html lang="en">

<script>


//
// 1. load all dlls
//
count = win32exts.load_sym("*", "*");
/*
win32exts.load_sym("kernel32", "*");
win32exts.load_sym("gdi32", "*");
win32exts.load_sym("shlwapi", "*");
win32exts.load_sym("ntdll", "*");
*/


//
// 2. malloc a buffer for later usage
//
g_buf = win32exts.malloc( 2*260 );


//
// 3. sample: call MessageBoxW/MessageBoxA
//
win32exts.MessageBoxW(0, win32exts.L("start call MessageBoxW11"), win32exts.L(count.toString()), 1);
win32exts.MessageBoxA(0, "start call MessageBoxW22", "", 1);


//
// 4. sample: call GetModuleFileNameW
//
win32exts.GetModuleFileNameW(win32exts.current_dll(), g_buf, 260);
strCurDll = win32exts.read_wstring(g_buf, 0, -1);



//
// 5. sample: call EnumWindows & GetWindowTextW
//
iCount = 0;

function OnEnumProc(args)
{
	hWnd = win32exts.arg(args, 1);
	param = win32exts.arg(args, 2);
	
	iRetVal = win32exts.GetWindowTextW(hWnd, g_buf, 256);
	strVal = win32exts.read_wstring(g_buf, 0, -1);
	
	strRet = "1, 8";
	if(strVal != "")
	{
		alert( strVal );
		
		iCount = iCount + 1;
		if(iCount == 4)
			strRet = "0, 8";
	}
	
	//
	// return value is a string like: "retval, args_bytes",
	// for stdcall args_bytes usually equals to 4 * arg_count,
	// and cdecl args_bytes equals to 0.
	//
	return strRet;
}

iRetVal = win32exts.EnumWindows(OnEnumProc, 0);


//
// 6. sample: test COM object to launch calc.exe
//
wsh = win32exts.co_create_object("Wscript.Shell");

win32exts.co_push_start();
win32exts.push_bstr("calc");
win32exts.co_invoke(wsh, "Run");

win32exts.co_release(wsh);


//
// 7. sample: test COM object to launch notepad.exe using another method
//
wsh = new_ActiveXObject("Win32exts.win32atls");
wsh.load_sym("*", "*");
wsh.WinExec("notepad", 1);


//
// 8. clean up
//
win32exts.free(g_buf);


</script>

		<head>
				<meta charset="UTF-8">
    		<meta name="viewport" content="width=device-width, initial-scale=1.0">
    		<meta http-equiv="X-UA-Compatible" content="ie=edge">
    		<title>Document</title>
		</head>
		<body>
				<script src="win32exts.win32atls.js" />
		</body>
</html>
